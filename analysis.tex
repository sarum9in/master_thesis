\chapter{Аналитический обзор межпроцессных взаимодействий
и формирование требований к ним}

Целью данной главы является анализ межпроцессных взаимодействий
в олимпиадной системе BACS, обзор существующих реализаций,
анализ требований и постановка цели и задач работы.

\section{Общая характеристика}
Межпроцессное взаимодействие IPC (inter-process communication) --
это обмен данными между отдельными процессами.
Процессы могут быть запущены как в одном адресном пространстве,
так и на удалённых компьютерах. Обеспечиваются такие взаимодействия
как посредством ядра операционной системы, так и при помощи механизмов
пользовательского пространства (к примеру внешних программных модулей).

Среди механизмов IPC выделяют механизмы обмена сообщениями, синхронизации,
разделения памяти и удалённых вызовов (RPC -- remote procedure call).
Для распределённых систем актуальны механизмы, независимые от ядра операционной
системы и позволяющие реализовывать связь между узлами, запущенными
под управлением различных операционных систем. К таким относятся механизмы
обмена сообщениями и удалённых вызовов.

\subsection{Обмен сообщениями}
Обмен сообщениями -- это форма связи, используемая в параллельных вычислениях,
реализуемая путём посылки пакетов информации получателям, которые могут
содержать команды и уведомления, а также данные для обработки.

Обычно обмен сообщениями реализуется асинхронно, сообщение может быть доставлено
неопределённому кругу получателей, в том числе независимо от отправителя,
если используется программа-посредник -- брокер. Наличие брокера с одной стороны
приводит к централизации системы, с другой позволяет упростить архитектуру.
Брокер хранит сообщения до момента доставки, уведомляет об ошибках,
реализует маршрутизацию сообщений.

\subsection{RPC}
Удалённый вызов процедур -- это класс технологий, позволяющих производить
вызов процедур одной компьютерной программы из адресного пространства другой.
Как правило реализации RPC позволяют абстрагироваться от деталей сетевого
взаимодействия, фактически стирая разницу между вызовом удалённой и локальной
процедуры.

Технологии RPC удобно применять для организации вычислений в распределённых
системах. В языках программирования высокого уровня команда есть вызов процедуры.
В распределённых системах таким образом команда есть удалённый вызов процедуры.
RPC позволяет передавать структурированные данные небольшого объёма (десятки
мегабайт). Так как используются типы данных языков программирования высокого
уровня, происходит прозрачная интеграция различных частей системы.

Любая технология RPC состоит из двух частей: протокола RPC и
реализации протокола для конкретных языков программирования. Следует обратить
внимание, что для большинства языков программирования следует создавать
отдельную реализацию (в некоторых случаях обёртку к существующей),
так как в каждом языке есть свои характерные особенности стиля работы,
что позволяет сделать реализацию максимально приближенной к языку и понятной
пользователям.

Протокол RPC с другой стороны является общим, он един для всех реализаций.
Это позволяет объединять различные узлы распределённой системы, реализованные
на различных языках программирования.

Протокол RPC обычно является двухуровневым.
Уровень представления данных определяет методы кодирования информации,
такие как байтовое представление чисел и других простых типов данных,
массивов, строк, структур.
Транспортный уровень определяет механизмы передачи уже закодированных байт
по сети. Часто используется какой-либо существующий протокол в качестве
транспортного.

\section{Обзор существующих технологий RPC}
\subsection{XML-RPC}
Использует XML для представления данных, HTTP в качестве транспортного протокола.

\noindent Пример запроса:
\begin{verbatim}
<?xml version="1.0"?>
<methodCall>
  <methodName>examples.getStateName</methodName>
  <params>
    <param>
     <value><i4>41</i4></value>
    </param>
  </params>
</methodCall>
\end{verbatim}

\noindent Пример ответа:
\begin{verbatim}
<?xml version="1.0"?>
<methodResponse>
  <params>
    <param>
      <value><string>South Dakota</string></value>
    </param>
  </params>
</methodResponse>
\end{verbatim}

Сильными сторонами технологии являются исключительная простота
и распространённость среди языков программирования. Недостатками являются
низкая производительность и избыточность представления данных (недостаток XML).
Последнее влечёт за собой чрезмерную нагрузку на сеть при значительных объёмах
передаваемых данных. В случае же если преобладают бинарные данные,
они кодируются в base64, специальной кодировке для представления бинарных
данных в текстовом виде. Особенностью данной кодировки является увеличение
размера передаваемой информации на 33\%.

\subsection{JSON-RPC}
Технология аналогична XML-RPC, за исключением использования JSON вместо XML.
Удобна для реализации в Web ввиду распространённости поддержки JSON
в браузерах. Сильные и слабые стороны те же.

\subsection{D-BUS}
Система для организации RPC в пределах одной операционной системы.
Оперирует концепцией сервиса: каждое серверное приложение при запуске
регистрирует сервис с заранее известным именем. Клиенты будут обращаться
к сервису при помощи данного имени.

Сообщения в D-Bus бывают четырёх видов: вызовы методов, результаты вызовов методов, сигналы (широковещательные сообщения) и ошибки.

Используется собственный бинарный протокол представления данных.
В качестве транспортного протокола используется как правило доменный сокет UNIX,
но может быть применён и TCP.

Сильными сторонами являются высокая скорость работы и широкая поддержка
в языках программирования. Так как технология ориентирована на работу
в пределах одного компьютера, для распределённых систем не подходит.

\subsection{Java RMI}
Java remote method invocation -- программный интерфейс вызова удалённых методов
в языке Java.
\begin{verbatim}
import java.rmi.Remote;
import java.rmi.RemoteException;

public interface RmiServerIntf extends Remote {
    public String getMessage() throws RemoteException;
}
\end{verbatim}

Для кодирования данных используется встроенная в язык технология сериализации.
В качестве транспортного протокола используется TCP с реализованным
поверх него собственным бинарным протоколом.

Сильными сторонами являются высокая скорость работы и бесшовная интеграция
с кодом на языке Java. Недостатком -- поддержка только платформы Java.
Последнее не позволяет создавать по-настоящему кросс-платформенные интерфейсы
в распределённых приложениях, если только для разработки не используется
исключительно Java.

\subsection{SOAP}
Simple Object Access Protocol -- простой протокол доступа к объектам.
Является расширением XML-RPC. Он является более гибким, но также добавляет
и свои недостатки к XML-RPC: существуют несовместимые реализации протокола.
Технология, как и XML-RPC, снижает скорость работы за счёт передачи данных
в форме XML.

\subsection{Apache Thrift}
Это язык описания интерфейсов для определения и создания служб
на различных языках программирования. Является фреймворком RPC.
Содержит генератор кода для таких языков как C\#, C++, Cappuccino, Cocoa,
Delphi, Erlang, Go, Haskell, Java, OCaml, Perl, PHP, Python, Ruby и Smalltalk.

Поддерживает множество форматов передачи и кодирования данных, среди них
бинарные и текстовые, в том числе отладочный (легко читаемый человеком), JSON.

Поддерживает различные транспортные протоколы, в том числе сетевые.

Сильными сторонами являются гибкость, распространённость реализаций
для различных языков программирования и совместимость между ними, высокая
скорость работы.
Основным недостатком выделяют низкое качество документации.
Кроме этого технология сериализации данных неотделима от фреймворка,
потому её использование для сохранения данных например на жёсткий диск
может быть затруднительно.

Технология широко применяется компанией Facebook для построения распределённых
систем.

\subsection{gRPC}
gRPC -- высокопроизводительный фреймворк для построения сервисов и клиентов.
Разрабатывается компанией Google, находится в открытом доступе.

Технология использует Google Protocol Buffers в качестве технологии
представления данных. Эта технология широко распространена среди
различных языков программирования.

В качестве протокола передачи данных используется HTTP/2 -- современная
версия протокола HTTP. Она отличается поддержкой параллельной передачи
данных в рамках одного соединения.

gRPC имеет реализации для C, C++, Java, Go, Node.js, Python, Ruby, Objective-C,
PHP и C\#. Отличается высокой скоростью работы и совместимостью между
реализациями. К недостаткам относят сложность анализа закодированных данных.
Также следует иметь ввиду что в настоящее время многие реализации являются
новыми и не получили достаточной стабильности работы.

\section{Требования к технологии RPC}

\section{Выводы, постановка цели и задач работы}
